
          echo "### 🌍 Where am I?" > widget.md
          echo "" >> widget.md
          echo "**📍 Currently in:** $currentCity, $currentCountry" >> widget.md
          echo "**🛫 Next:** $nextCity, $nextCountry — *${nextStart}–${nextEnd}* " >> widget.md
          echo "**🛬 Last:** $lastCity, $lastCountry — *${lastStart}–${lastEnd}*" >> widget.md
          echo "" >> widget.md
          echo "**🧭 Stats**" >> widget.md
          echo "- **Countries visited:** $countries" >> widget.md
          echo "- **Cities visited:** $cities" >> widget.md
          echo "- **Distance traveled:** ${distanceKm} km / ${distanceMiles} mi" >> widget.md
          echo "- **Most visited city:** $mostCityName ($mostCityTrips trips)" >> widget.md
          echo "- **Longest stay:** $longestCityName — $longestCityDays days" >> widget.md
          echo "" >> widget.md
          echo "**🗺 Map:** [View Nomads Travel Map](https://url2og.com/?url=https%3A%2F%2Fnomads.com%2F%40danielreilly%3Fmap_only%3Dtrue%26key%3Db9ec566fe67015f63c7d6225ff9e5a4d)" >> widget.md

          awk '/<!-- WIDGET_START -->/ { print; system("cat widget.md"); in_widget=1; next } /<!-- WIDGET_END -->/ { print; in_widget=0; next } !in_widget { print }' README.md > temp.md
          mv temp.md README.md

      - name: Commit changes
        run: |
          git config --global user.name "github-actions[bot]"
          git config --global user.email "github-actions[bot]@users.noreply.github.com"
          git add README.md
          if git diff-index --quiet HEAD; then
            echo "No changes to commit"
          else
            git commit -m "Update dynamic widget"
            git push origin HEAD:${{ github.ref }}
          fi
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
